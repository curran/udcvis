<!DOCTYPE html>  <html> <head>   <title>script.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               script.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>This script draws a histogram for a set of grades on an HTML5 canvas.</p>

<h2>Configurable variables</h2>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">grades</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">];</span>

<span class="kd">var</span> <span class="nx">margin</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">bottom</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span>
  <span class="nx">top</span><span class="o">:</span> <span class="mi">5</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">barSpacing</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">labelYOffset</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">fontSize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>Graphics utilities</h2>

<p>The script expects the containing HTML page to contain a canvas element 
whose id is "canvas".</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">canvas</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;canvas&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s1">&#39;2d&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">drawRectangle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x1</span><span class="p">,</span> <span class="nx">x2</span><span class="p">,</span> <span class="nx">y1</span><span class="p">,</span> <span class="nx">y2</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">x1</span><span class="p">,</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">y1</span><span class="p">,</span>
      <span class="nx">width</span> <span class="o">=</span> <span class="nx">x2</span> <span class="o">-</span> <span class="nx">x1</span><span class="p">,</span> <span class="nx">height</span> <span class="o">=</span> <span class="nx">y2</span> <span class="o">-</span> <span class="nx">y1</span><span class="p">;</span>
  <span class="nx">c</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">plotBounds</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">xMin</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nx">xMax</span><span class="o">:</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span>
  <span class="nx">yMin</span><span class="o">:</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span> <span class="o">-</span> <span class="nx">margin</span><span class="p">.</span><span class="nx">bottom</span><span class="p">,</span>
  <span class="nx">yMax</span><span class="o">:</span> <span class="nx">margin</span><span class="p">.</span><span class="nx">top</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h2>Functional programming utilities</h2>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">each</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="nx">callback</span><span class="cm">/*(element, i)*/</span><span class="p">){</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
    <span class="nx">callback</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">);</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="nx">callback</span><span class="cm">/*(element, i)*/</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">mappedArr</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
    <span class="nx">mappedArr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">callback</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">));</span>
  <span class="k">return</span> <span class="nx">mappedArr</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Given an array of strings, this function returns an array
of integers parsed from those strings.</p>

<p>For example, <code>ints(["5","10","15"])</code> = <code>[5,10,15]</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">ints</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">map</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">){</span>
    <span class="k">return</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Computes the min and max values for a given array of numbers.
The callback is called with the min and max as arguments.</p>

<p>For example, <code>minMax([0,5,15],function(min, max){console.log(min,max);})</code>
prints "0 15".</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">minMax</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="nx">callback</span><span class="cm">/*(min, max)*/</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">min</span> <span class="o">=</span> <span class="nb">Number</span><span class="p">.</span><span class="nx">MAX_VALUE</span><span class="p">,</span> <span class="nx">max</span> <span class="o">=</span> <span class="o">-</span><span class="nx">min</span><span class="p">;</span>
  <span class="nx">each</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span> <span class="nx">max</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">x</span> <span class="o">&lt;</span> <span class="nx">min</span><span class="p">)</span> <span class="p">{</span> <span class="nx">min</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">});</span>
  <span class="nx">callback</span><span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Returns the keys of a given object as an array.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">arrKeys</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span>
    <span class="nx">arrKeys</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">arrKeys</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Returns the values of a given object as an array.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">values</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">arrValues</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span>
    <span class="nx">arrValues</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
  <span class="k">return</span> <span class="nx">arrValues</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Returns an array of integers between min and max (inclusive).</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">range</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">min</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">max</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
    <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <h2>Linear Interpolation Utilities</h2>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/**</span>
<span class="cm"> * This way of implementing interpolation is not appropriate for</span>
<span class="cm"> * use in tight loops because it creates 4 new objects</span>
<span class="cm"> * on each call, making the garbage collector work hard,</span>
<span class="cm"> * slowing performance.</span>
<span class="cm"> */</span>
<span class="kd">var</span> <span class="nx">interpolate_crappyImplementation</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">from</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">min1</span><span class="p">,</span> <span class="nx">max1</span><span class="p">){</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">to</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">min2</span><span class="p">,</span> <span class="nx">max2</span><span class="p">){</span>
          <span class="k">return</span> <span class="p">(</span><span class="nx">value</span> <span class="o">-</span> <span class="nx">min1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nx">max1</span> <span class="o">-</span> <span class="nx">min1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nx">max2</span> <span class="o">-</span> <span class="nx">min2</span><span class="p">)</span> <span class="o">+</span> <span class="nx">min2</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">};</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>This exposes an API that looks like this when used: 
<code>interpolate(value).from(min1, max1).to(min2, max2)</code>.
The <code>value</code> passed in initially is expected to fall within
the interval (min1, min2). The returned value is a linear
interpolation of the original value to a value within the
interval (min2, max2).</p>

<p>For example, <code>interpolate(0.5).from(0,1).to(0,100)</code> = 50.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/**</span>
<span class="cm"> * This way of implementing interpolation, while more verbose,</span>
<span class="cm"> * is appropriate for use in tight loops, </span>
<span class="cm"> * as no new objects are created on each call.</span>
<span class="cm"> * All objects are created once, stored in a</span>
<span class="cm"> * closure, and re-used on each call.</span>
<span class="cm"> */</span>
<span class="kd">var</span> <span class="nx">interpolate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">_value</span><span class="p">,</span> <span class="nx">_min1</span><span class="p">,</span> <span class="nx">_max1</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">chain</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">from</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">min1</span><span class="p">,</span> <span class="nx">max1</span><span class="p">){</span>
      <span class="nx">_min1</span> <span class="o">=</span> <span class="nx">min1</span><span class="p">;</span>
      <span class="nx">_max1</span> <span class="o">=</span> <span class="nx">max1</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">chain</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">to</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">min2</span><span class="p">,</span> <span class="nx">max2</span><span class="p">){</span>
      <span class="k">return</span> <span class="p">(</span><span class="nx">_value</span> <span class="o">-</span> <span class="nx">_min1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nx">_max1</span> <span class="o">-</span> <span class="nx">_min1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nx">max2</span> <span class="o">-</span> <span class="nx">min2</span><span class="p">)</span> <span class="o">+</span> <span class="nx">min2</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">};</span>
  <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span>
    <span class="nx">_value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">chain</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">}();</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <h2>Grade Bins</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>In the <code>gradeBins</code> object,</p>

<ul>
<li>Keys are integer grades that define bins.</li>
<li>Values are integer sums for occurences those grades.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">gradeBins</span> <span class="o">=</span> <span class="p">{};</span>

<span class="kd">var</span> <span class="nx">addGradesToBins</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">each</span><span class="p">(</span><span class="nx">grades</span><span class="p">,</span> <span class="nx">addGradeToBins</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">addGradeToBins</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grade</span><span class="p">){</span>
  <span class="nx">gradeBins</span><span class="p">[</span><span class="nx">grade</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">gradeBins</span><span class="p">[</span><span class="nx">grade</span><span class="p">]</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="nx">grade</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <h2>Drawing Bars</h2>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">drawBarsFromBins</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">minMax</span><span class="p">(</span><span class="nx">ints</span><span class="p">(</span><span class="nx">keys</span><span class="p">(</span><span class="nx">gradeBins</span><span class="p">)),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">minGrade</span><span class="p">,</span> <span class="nx">maxGrade</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">barWidth</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">/</span> <span class="p">(</span><span class="nx">maxGrade</span> <span class="o">-</span> <span class="nx">minGrade</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nx">barWidth</span> <span class="o">-=</span> <span class="nx">barSpacing</span><span class="p">;</span>

    <span class="nx">minMax</span><span class="p">(</span><span class="nx">values</span><span class="p">(</span><span class="nx">gradeBins</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">minGradeBinSum</span><span class="p">,</span> <span class="nx">maxGradeBinSum</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Set <code>minGradeBinSum = 0</code> so the bar chart shows bars that
start from 0 rather than the minimum grade bin sum value.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">minGradeBinSum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nx">each</span><span class="p">(</span><span class="nx">range</span><span class="p">(</span><span class="nx">minGrade</span><span class="p">,</span> <span class="nx">maxGrade</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grade</span><span class="p">,</span> <span class="nx">i</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">gradeBinSum</span> <span class="o">=</span> <span class="nx">gradeBins</span><span class="p">[</span><span class="nx">grade</span><span class="p">]</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">barX1</span> <span class="o">=</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">grade</span><span class="p">)</span>
                     <span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="nx">minGrade</span><span class="p">,</span> <span class="nx">maxGrade</span><span class="p">)</span>
                     <span class="p">.</span><span class="nx">to</span><span class="p">(</span><span class="nx">plotBounds</span><span class="p">.</span><span class="nx">xMin</span><span class="p">,</span> <span class="nx">plotBounds</span><span class="p">.</span><span class="nx">xMax</span> <span class="o">-</span> <span class="nx">barWidth</span><span class="p">),</span>
            <span class="nx">barX2</span> <span class="o">=</span> <span class="nx">barX1</span> <span class="o">+</span> <span class="nx">barWidth</span><span class="p">,</span>
            <span class="nx">barY1</span> <span class="o">=</span> <span class="nx">plotBounds</span><span class="p">.</span><span class="nx">yMin</span><span class="p">,</span>
            <span class="nx">barY2</span> <span class="o">=</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">gradeBinSum</span><span class="p">)</span>
                     <span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="nx">minGradeBinSum</span><span class="p">,</span> <span class="nx">maxGradeBinSum</span><span class="p">)</span>
                     <span class="p">.</span><span class="nx">to</span><span class="p">(</span><span class="nx">plotBounds</span><span class="p">.</span><span class="nx">yMin</span><span class="p">,</span> <span class="nx">plotBounds</span><span class="p">.</span><span class="nx">yMax</span><span class="p">),</span>
            <span class="nx">labelX</span> <span class="o">=</span> <span class="p">(</span><span class="nx">barX1</span> <span class="o">+</span> <span class="nx">barX2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="nx">labelY</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Draw the bar.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">drawRectangle</span><span class="p">(</span><span class="nx">barX1</span><span class="p">,</span> <span class="nx">barX2</span><span class="p">,</span> <span class="nx">barY1</span><span class="p">,</span> <span class="nx">barY2</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Draw the white text inside the bar.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">labelY</span> <span class="o">=</span> <span class="nx">barY2</span> <span class="o">+</span> <span class="nx">labelYOffset</span><span class="p">;</span>
        <span class="nx">c</span><span class="p">.</span><span class="nx">font</span> <span class="o">=</span> <span class="nx">fontSize</span><span class="o">+</span><span class="s1">&#39;px san-serif&#39;</span><span class="p">;</span>
        <span class="nx">c</span><span class="p">.</span><span class="nx">textAlign</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">;</span>
        <span class="nx">c</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">;</span>
        <span class="nx">c</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="nx">gradeBinSum</span><span class="p">,</span> <span class="nx">labelX</span><span class="p">,</span> <span class="nx">labelY</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Draw the black text under the bar.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">labelY</span> <span class="o">=</span> <span class="nx">barY1</span> <span class="o">+</span> <span class="nx">labelYOffset</span><span class="p">;</span>
        <span class="nx">c</span><span class="p">.</span><span class="nx">textAlign</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">;</span>
        <span class="nx">c</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">;</span>
        <span class="nx">c</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="nx">grade</span><span class="p">,</span> <span class="nx">labelX</span><span class="p">,</span> <span class="nx">labelY</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <h2>The Main Program</h2>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">addGradesToBins</span><span class="p">();</span>
<span class="nx">drawBarsFromBins</span><span class="p">();</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 